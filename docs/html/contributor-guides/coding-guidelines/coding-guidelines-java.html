
<!DOCTYPE html>

<html lang="en" data-content_root="../../">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Coding Guidelines for Java &#8212; OpenDaylight Documentation Chromium documentation</title>
    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css?v=03e43079" />
    <link rel="stylesheet" type="text/css" href="../../_static/bootstrap-sphinx.css?v=0bf093e7" />
    <link rel="stylesheet" type="text/css" href="../../_static/graphviz.css?v=4ae1632d" />
    <link rel="stylesheet" type="text/css" href="https://cdn.datatables.net/1.11.2/css/jquery.dataTables.min.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/css/ribbon.css?v=cb953b18" />
    <link rel="stylesheet" href="../../_static/css/warning-header.css" type="text/css" />
    <script src="../../_static/documentation_options.js?v=7b4a4459"></script>
    <script src="../../_static/doctools.js?v=9bcbadda"></script>
    <script src="../../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="https://cdn.datatables.net/1.11.2/js/jquery.dataTables.min.js"></script>
    <script class="init" type="text/javascript">$(document).ready( function () { $('table.datatable').DataTable(); } );</script>
    <link rel="icon" href="../../_static/favicon.ico"/>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="Coding Guidelines for Python" href="coding-guidelines-python.html" />
    <link rel="prev" title="Generic Coding Guidelines" href="coding-guidelines-generic.html" />
<meta charset='utf-8'>
<meta http-equiv='X-UA-Compatible' content='IE=edge,chrome=1'>
<meta name='viewport' content='width=device-width, initial-scale=1.0, maximum-scale=1'>
<meta name="apple-mobile-web-app-capable" content="yes">
<script type="text/javascript" src="../../_static/js/jquery-1.12.4.min.js"></script>
<script type="text/javascript" src="../../_static/js/jquery-fix.js"></script>
<script type="text/javascript" src="../../_static/bootstrap-3.4.1/js/bootstrap.min.js"></script>
<script type="text/javascript" src="../../_static/bootstrap-sphinx.js"></script>

  </head><body>
  <div class="ribbon">
    <a href="https://jira.opendaylight.org/secure/CreateIssueDetails!init.jspa
?pid=10121
&issuetype=10104
&components=10228
&priority=2
&description=version:+Chromium%0Apage:+contributor-guides/coding-guidelines/coding-guidelines-java%0A%0A" target="_blank">
      Report Issue
    </a>
  </div>
  

<div id="navbar" class="navbar navbar-default navbar-fixed-top">
  <!-- Outdated version warning banner -->
  
    <style>
      body {
        padding-top: 60px;
     }
    </style>
  
    <div class="container">
      <div class="navbar-header">
        <!-- .btn-navbar is used as the toggle for collapsed navbar content -->
        <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".nav-collapse">
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
        </button>
        <a class="navbar-brand" href="../../index.html">
          OpenDaylight Documentation</a>
        <span class="navbar-text navbar-version pull-left"><b>Chromium</b></span>
      </div>

        <div class="collapse navbar-collapse nav-collapse">
          <ul class="nav navbar-nav">
            
            
              <li class="dropdown globaltoc-container">
  <a role="button"
     id="dLabelGlobalToc"
     data-toggle="dropdown"
     data-target="#"
     href="../../index.html">Site <b class="caret"></b></a>
  <ul class="dropdown-menu globaltoc"
      role="menu"
      aria-labelledby="dLabelGlobalToc"><ul>
<li class="toctree-l1"><a class="reference internal" href="../../downloads.html">OpenDaylight Downloads</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../release-notes/index.html">Release Notes</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../getting-started-guide/index.html">Getting Started Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../developer-guides/index.html">Developer Guides</a></li>
</ul>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../documentation.html">Documentation Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../release-process/index.html">OpenDaylight Release Process Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../javadoc.html">Java API Documentation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../user-guide/index.html">OpenDaylight User Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../developer-guides/index.html">Developer Guides</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../index.html">Contributor Guides</a></li>
</ul>
</ul>
</li>
              
                <li class="dropdown">
  <a role="button"
     id="dLabelLocalToc"
     data-toggle="dropdown"
     data-target="#"
     href="#">Page <b class="caret"></b></a>
  <ul class="dropdown-menu localtoc"
      role="menu"
      aria-labelledby="dLabelLocalToc"><ul>
<li><a class="reference internal" href="#">Coding Guidelines for Java</a><ul>
<li><a class="reference internal" href="#checkstyle">Checkstyle</a><ul>
<li><a class="reference internal" href="#utility-classes-with-only-static-methods">Utility classes with only static methods</a></li>
<li><a class="reference internal" href="#suggested-process-steps-to-move-a-non-compliant-project-to-enforcement">Suggested process (steps) to move a non-compliant project to enforcement</a></li>
<li><a class="reference internal" href="#suppresswarnings"><code class="docutils literal notranslate"><span class="pre">&#64;SuppressWarnings</span></code></a></li>
<li><a class="reference internal" href="#notes-for-particular-checks">Notes for particular Checks</a><ul>
<li><a class="reference internal" href="#inheritdoc-javadoc">{&#64;inheritDoc} JavaDoc</a></li>
<li><a class="reference internal" href="#illegalthrows">IllegalThrows</a></li>
<li><a class="reference internal" href="#illegalcatch">IllegalCatch</a></li>
<li><a class="reference internal" href="#system-out"><code class="docutils literal notranslate"><span class="pre">System.out</span></code></a></li>
<li><a class="reference internal" href="#javadoc-paragraph-p-tag-should-be-preceded-with-an-empty-line">Javadoc Paragraph: &lt; p &gt; tag should be preceded with an empty line</a></li>
</ul>
</li>
<li><a class="reference internal" href="#additional-resources">Additional Resources</a></li>
</ul>
</li>
<li><a class="reference internal" href="#classes-methods-fields-ordering">Classes methods / fields ordering</a></li>
<li><a class="reference internal" href="#error-prone">error-prone</a></li>
<li><a class="reference internal" href="#spotbugs">SpotBugs</a></li>
<li><a class="reference internal" href="#findbugs">FindBugs</a><ul>
<li><a class="reference internal" href="#fbsuppresswarnings"><code class="docutils literal notranslate"><span class="pre">&#64;FBSuppressWarnings</span></code></a></li>
<li><a class="reference internal" href="#unchecked-unconfirmed-cast-from-com-google-common-truth-subject-to-com-google-common-truth-booleansubject-etc">Unchecked/unconfirmed cast from <code class="docutils literal notranslate"><span class="pre">com.google.common.truth.Subject</span></code> to <code class="docutils literal notranslate"><span class="pre">com.google.common.truth.BooleanSubject</span></code> etc.</a></li>
<li><a class="reference internal" href="#null-analysis-errors-incl-findbugs-np-nonnull-field-not-initialized-in-constructor">null analysis errors, incl. FindBugs’ NP_NONNULL_FIELD_NOT_INITIALIZED_IN_CONSTRUCTOR</a><ul>
<li><a class="reference internal" href="#nonnullandoptional"><code class="docutils literal notranslate"><span class="pre">nonNullAndOptional</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#everything-nonnullbydefault">Everything <code class="docutils literal notranslate"><span class="pre">&#64;NonNullByDefault</span></code></a></li>
<li><a class="reference internal" href="#null-annotations-from-org-eclipse-jdt-annotation-instead-of-javax-annotation">null annotations from <code class="docutils literal notranslate"><span class="pre">org.eclipse.jdt.annotation</span></code> instead of <code class="docutils literal notranslate"><span class="pre">javax.annotation</span></code></a></li>
<li><a class="reference internal" href="#null-analysis-by-findbugs-vs-eclipse-jdt">null analysis by FindBugs VS. Eclipse JDT</a></li>
<li><a class="reference internal" href="#runtime-null-checks">Runtime null checks</a></li>
<li><a class="reference internal" href="#nullable-errors-for-fields-related-to-dependency-injection"><code class="docutils literal notranslate"><span class="pre">nullable</span></code> errors for fields related to dependency injection</a></li>
<li><a class="reference internal" href="#optional">Optional</a><ul>
<li><a class="reference internal" href="#further-reading-watching">Further Reading &amp; Watching</a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#streaming-and-lambdas">Streaming and lambdas</a></li>
<li><a class="reference internal" href="#pre-review-guidance">Pre-review guidance</a></li>
</ul>
</li>
</ul>
</ul>
</li>
              
            
            
            
            
            
          </ul>

          
            
<form class="navbar-form navbar-right" action="../../search.html" method="get">
 <div class="form-group">
  <input type="text" name="q" class="form-control" placeholder="Search" />
 </div>
  <input type="hidden" name="check_keywords" value="yes" />
  <input type="hidden" name="area" value="default" />
</form>
          
        </div>
    </div>
  </div>

<div class="container">
  <div class="row">
      <div class="col-md-3">
        <div id="sidebar" class="bs-sidenav" role="complementary"><ul>
<li><a class="reference internal" href="#">Coding Guidelines for Java</a><ul>
<li><a class="reference internal" href="#checkstyle">Checkstyle</a><ul>
<li><a class="reference internal" href="#utility-classes-with-only-static-methods">Utility classes with only static methods</a></li>
<li><a class="reference internal" href="#suggested-process-steps-to-move-a-non-compliant-project-to-enforcement">Suggested process (steps) to move a non-compliant project to enforcement</a></li>
<li><a class="reference internal" href="#suppresswarnings"><code class="docutils literal notranslate"><span class="pre">&#64;SuppressWarnings</span></code></a></li>
<li><a class="reference internal" href="#notes-for-particular-checks">Notes for particular Checks</a><ul>
<li><a class="reference internal" href="#inheritdoc-javadoc">{&#64;inheritDoc} JavaDoc</a></li>
<li><a class="reference internal" href="#illegalthrows">IllegalThrows</a></li>
<li><a class="reference internal" href="#illegalcatch">IllegalCatch</a></li>
<li><a class="reference internal" href="#system-out"><code class="docutils literal notranslate"><span class="pre">System.out</span></code></a></li>
<li><a class="reference internal" href="#javadoc-paragraph-p-tag-should-be-preceded-with-an-empty-line">Javadoc Paragraph: &lt; p &gt; tag should be preceded with an empty line</a></li>
</ul>
</li>
<li><a class="reference internal" href="#additional-resources">Additional Resources</a></li>
</ul>
</li>
<li><a class="reference internal" href="#classes-methods-fields-ordering">Classes methods / fields ordering</a></li>
<li><a class="reference internal" href="#error-prone">error-prone</a></li>
<li><a class="reference internal" href="#spotbugs">SpotBugs</a></li>
<li><a class="reference internal" href="#findbugs">FindBugs</a><ul>
<li><a class="reference internal" href="#fbsuppresswarnings"><code class="docutils literal notranslate"><span class="pre">&#64;FBSuppressWarnings</span></code></a></li>
<li><a class="reference internal" href="#unchecked-unconfirmed-cast-from-com-google-common-truth-subject-to-com-google-common-truth-booleansubject-etc">Unchecked/unconfirmed cast from <code class="docutils literal notranslate"><span class="pre">com.google.common.truth.Subject</span></code> to <code class="docutils literal notranslate"><span class="pre">com.google.common.truth.BooleanSubject</span></code> etc.</a></li>
<li><a class="reference internal" href="#null-analysis-errors-incl-findbugs-np-nonnull-field-not-initialized-in-constructor">null analysis errors, incl. FindBugs’ NP_NONNULL_FIELD_NOT_INITIALIZED_IN_CONSTRUCTOR</a><ul>
<li><a class="reference internal" href="#nonnullandoptional"><code class="docutils literal notranslate"><span class="pre">nonNullAndOptional</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#everything-nonnullbydefault">Everything <code class="docutils literal notranslate"><span class="pre">&#64;NonNullByDefault</span></code></a></li>
<li><a class="reference internal" href="#null-annotations-from-org-eclipse-jdt-annotation-instead-of-javax-annotation">null annotations from <code class="docutils literal notranslate"><span class="pre">org.eclipse.jdt.annotation</span></code> instead of <code class="docutils literal notranslate"><span class="pre">javax.annotation</span></code></a></li>
<li><a class="reference internal" href="#null-analysis-by-findbugs-vs-eclipse-jdt">null analysis by FindBugs VS. Eclipse JDT</a></li>
<li><a class="reference internal" href="#runtime-null-checks">Runtime null checks</a></li>
<li><a class="reference internal" href="#nullable-errors-for-fields-related-to-dependency-injection"><code class="docutils literal notranslate"><span class="pre">nullable</span></code> errors for fields related to dependency injection</a></li>
<li><a class="reference internal" href="#optional">Optional</a><ul>
<li><a class="reference internal" href="#further-reading-watching">Further Reading &amp; Watching</a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#streaming-and-lambdas">Streaming and lambdas</a></li>
<li><a class="reference internal" href="#pre-review-guidance">Pre-review guidance</a></li>
</ul>
</li>
</ul>
<center>
<div class="btn-group" role="group" aria-label="...">
    
    <a class="btn btn-default" href="coding-guidelines-generic.html">Prev Page</a>
    

    
    <a class="btn btn-default" href="coding-guidelines-python.html">Next Page</a>
    
</div>
</center>
        </div>
      </div>
    <div class="body col-md-9 content" role="main">
      
  <section id="coding-guidelines-for-java">
<span id="coding-guidelines-java"></span><h1>Coding Guidelines for Java<a class="headerlink" href="#coding-guidelines-for-java" title="Link to this heading">¶</a></h1>
<p><em>Note: This document is a work in progress.</em></p>
<p>In General we follow the Google Java Code Style Guide with a few exceptions.
See: <a class="reference external" href="https://google.github.io/styleguide/javaguide.html">https://google.github.io/styleguide/javaguide.html</a></p>
<ul class="simple">
<li><p>4 spaces indentation</p></li>
<li><p>8-space indentation on next line for method parameters</p></li>
<li><p>120 characters line length</p></li>
<li><p>72 or 80 characters for Javadoc</p></li>
<li><p>import ordering
(<a class="reference external" href="https://wiki-archive.opendaylight.org/view/GettingStarted:_Eclipse_Setup#Import_ordering">https://wiki-archive.opendaylight.org/view/GettingStarted:_Eclipse_Setup#Import_ordering</a>)</p></li>
<li><p>YangTools Design Guidelines
(<a class="reference external" href="https://wiki-archive.opendaylight.org/view/YANG_Tools:Design_and_Coding_Guidelines">https://wiki-archive.opendaylight.org/view/YANG_Tools:Design_and_Coding_Guidelines</a>)</p></li>
<li><p>follow JLS modifier ordering
(<a class="reference external" href="https://checkstyle.sourceforge.io/checks/modifier/modifierorder.html">https://checkstyle.sourceforge.io/checks/modifier/modifierorder.html</a>)</p></li>
<li><p>do not use underscores (_) in identifiers, as they trigger warnings with JDK8</p></li>
<li><p>Uppercase “ <em>static final Logger LOG = …</em> “ (See 5.2.4 examples)</p></li>
<li><p>prefer immutability: mark method parameters and local variables as <code class="docutils literal notranslate"><span class="pre">final</span></code> where practical</p></li>
</ul>
<section id="checkstyle">
<h2>Checkstyle<a class="headerlink" href="#checkstyle" title="Link to this heading">¶</a></h2>
<p>All OpenDaylight projects automatically run Checkstyle, as the
<code class="docutils literal notranslate"><span class="pre">maven-checkstyle-plugin</span></code> is declared in the odlparent.</p>
<p>Checkstyle Warnings are considered as errors by default since Magnesium.
They will prevent your project from building if code violations are found.
Checkstyle enforcement can be disabled by defining the following property in the
related pom.xml:</p>
<blockquote>
<div><div class="highlight-none notranslate"><div class="highlight"><pre><span></span>&lt;properties&gt;
 &lt;odlparent.checkstyle.enforce&gt;false&lt;/odlparent.checkstyle.enforce&gt;
&lt;/properties&gt;
</pre></div>
</div>
</div></blockquote>
<section id="utility-classes-with-only-static-methods">
<h3>Utility classes with only static methods<a class="headerlink" href="#utility-classes-with-only-static-methods" title="Link to this heading">¶</a></h3>
<p>In general we recommend that you typically do not overuse utility classes with
only static methods, but instead write helper &#64;Singleton classes without static
methods which you can easily &#64;Inject via Dependency Injection into other classes
requiring them.
This makes it easier to use non-static helpers in other utilities which can then
in turn be &#64;Inject into your helper (which you cannot do with static).
It also makes it easier to mock the helpers for use in unit tests.</p>
<p>If you must write utility classes with only static methods, or have existing
code that is not trivial to change, then please mark the respective class final,
and give it a private constructor.
Please do not throw any exception from the private constructor
(it is not required).</p>
</section>
<section id="suggested-process-steps-to-move-a-non-compliant-project-to-enforcement">
<h3>Suggested process (steps) to move a non-compliant project to enforcement<a class="headerlink" href="#suggested-process-steps-to-move-a-non-compliant-project-to-enforcement" title="Link to this heading">¶</a></h3>
<p>We recommend moving existing at least large projects (which typically have
hundreds or thousands of Checkstyle violations) to full compliance and
enforcement through a series of Gerrit changes on single artefacts (bundles),
as opposed to a single change fixing everything and change the POM to enable
enforcement all in one go (god forbid for an entire repository and not just a
single artifact), because:</p>
<ol class="arabic simple">
<li><p>single review would be virtually impossible to even remotely sensibly
code review by committers</p></li>
<li><p>batching style changes by type is easy to review (and approve lines
in bulk “by trust”), for example:</p>
<ol class="arabic simple">
<li><p><em>(…project name…) Organize Imports for Checkstyle compliance</em></p></li>
<li><p><em>(…project name…) Checkstyle compliance: line length</em></p></li>
<li><p><em>(…project name…) Checkstyle compliance: various types of
small changes</em></p></li>
<li><p>‘’(…project name…) Checkstyle compliant Exception handling’</p></li>
<li><p>‘’(…project name…) Checkstyle final clean up &amp; enforcement’</p></li>
</ol>
</li>
<li><p>it’s particularly important to split and separately submit
“trivial pure cosmetic” (e.g. code formatting) from “interesting impactful”
(e.g. changes to exception handling) changes required by Checkstyle</p></li>
<li><p>in general, doing small steps and intermediate merges are more rewarding for
contributing developers than long running massive Gerrit changes</p></li>
<li><p>more small changes makes the contributors Stats Great Again
(ODL top contributors submit massive amounts of micro changes)</p></li>
</ol>
<p>During such a process, it should be considered “normal” and perfectly
acceptable, that new intermediately merged changes introduce some (small)
regressions and “re-dirty” some previously cleaned up files;
it’s OK that they’ll be re-fixed as part of new changes by the developers
contributing the clean up in new changes (or rebases)
- until enforcement is enabled at the end of a series of clean up changes.</p>
</section>
<section id="suppresswarnings">
<h3><code class="docutils literal notranslate"><span class="pre">&#64;SuppressWarnings</span></code><a class="headerlink" href="#suppresswarnings" title="Link to this heading">¶</a></h3>
<p>If really needed, projects can override individual Checkstyle rules on a
case-by-case basis by using a <code class="docutils literal notranslate"><span class="pre">&#64;SuppressWarnings</span></code> annotation:</p>
<blockquote>
<div><div class="highlight-none notranslate"><div class="highlight"><pre><span></span>@SuppressWarnings(&quot;checkstyle:methodparampad&quot;)
public AbstractDataTreeListener (INetvirtSfcOF13Provider provider, Class&lt;T&gt; clazz) {
}
</pre></div>
</div>
</div></blockquote>
<p>The rule ID (e.g. <code class="docutils literal notranslate"><span class="pre">checkstyle:methodparampad</span></code> above) is the name of the
respective Checkstyle module; these IDs can be found e.g. in the
<code class="docutils literal notranslate"><span class="pre">git/odlparent/checkstyle/src/main/resources/odl_checks.xml</span></code>
configuration, or directly on the Checkstyle website from the
<a class="reference external" href="https://checkstyle.sourceforge.net/checks.html">https://checkstyle.sourceforge.net/checks.html</a> list.
For example, for the
<a class="reference external" href="https://checkstyle.sourceforge.net/config_coding.html#EqualsHashCode">https://checkstyle.sourceforge.net/config_coding.html#EqualsHashCode</a> rule
you would put <code class="docutils literal notranslate"><span class="pre">&#64;SuppressWarnings(&quot;checkstyle:EqualsHashCode&quot;)</span></code>.</p>
<p>This <code class="docutils literal notranslate"><span class="pre">&#64;SuppressWarnings(&quot;checkstyle:...&quot;)</span></code> should in practice be very very rarely
needed.
Please put a comment explaining why you need to suppress a Checkstyle warning
into the code for other to understand, for example:</p>
<blockquote>
<div><div class="highlight-none notranslate"><div class="highlight"><pre><span></span>@Override
@SuppressWarnings(&quot;checkstyle:EqualsHashCode&quot;
// In this particular case an equals without hashCode is OK because
// [explain!] (I&#39;m a certified grown up and know what I&#39;m doing.)
public boolean equals(Object obj) {
</pre></div>
</div>
</div></blockquote>
<p>Please contact <a class="reference external" href="mailto:odlparent-dev&#37;&#52;&#48;lists&#46;opendaylight&#46;org">odlparent-dev<span>&#64;</span>lists<span>&#46;</span>opendaylight<span>&#46;</span>org</a> if you feel a Checkstyle
rule is too strict in general and should be reviewed.</p>
<p>The <a class="reference external" href="https://wiki-archive.opendaylight.org/view/EvolvingCheckstyle">Evolving Checkstyle old wiki page</a>
documents how to test changes to Checkstyle rules.</p>
</section>
<section id="notes-for-particular-checks">
<h3>Notes for particular Checks<a class="headerlink" href="#notes-for-particular-checks" title="Link to this heading">¶</a></h3>
<section id="inheritdoc-javadoc">
<h4><a class="reference external" href="mailto:{&#37;&#52;&#48;inheritDoc">{<span>&#64;</span>inheritDoc</a>} JavaDoc<a class="headerlink" href="#inheritdoc-javadoc" title="Link to this heading">¶</a></h4>
<p>This JavaDoc is useless visual noise that hinders code readability.
It is not required to put this, and has no impact. JavaDoc does this by default:</p>
<div class="highlight-java notranslate"><div class="highlight"><pre><span></span><span class="cm">/**</span>
<span class="cm"> * {@inheritDoc}</span>
<span class="cm"> */</span>
<span class="nd">@Override</span><span class="w"> </span><span class="c1">// (or on a constructor)</span>
</pre></div>
</div>
<p>The only case where <a class="reference external" href="mailto:{&#37;&#52;&#48;inheritDoc">{<span>&#64;</span>inheritDoc</a>} is useful is when you actually have
additional Java documentation.
Default JavaDoc interprets as replace the parent documentation.
If you truly want the full text of the parent to be copy/pasted by JavaDoc in
addition to your additional one, then use:</p>
<div class="highlight-java notranslate"><div class="highlight"><pre><span></span><span class="cm">/**</span>
<span class="cm"> * {@inheritDoc}</span>
<span class="cm"> * For this specific implementation...</span>
<span class="cm"> */</span>
<span class="nd">@Override</span><span class="w"> </span><span class="c1">// (or on a constructor)</span>
</pre></div>
</div>
<p>See also
<a class="reference external" href="https://github.com/sevntu-checkstyle/sevntu.checkstyle/issues/467">https://github.com/sevntu-checkstyle/sevntu.checkstyle/issues/467</a> &amp;
<a class="reference external" href="http://tornorbye.blogspot.ch/2005/02/inheriting-javadoc-comments.html">http://tornorbye.blogspot.ch/2005/02/inheriting-javadoc-comments.html</a></p>
</section>
<section id="illegalthrows">
<h4>IllegalThrows<a class="headerlink" href="#illegalthrows" title="Link to this heading">¶</a></h4>
<p>Instead of declaring “throws Exception”, in almost all cases you should instead
throw a custom existing or new ODL Exception.
Instead of an unchecked exception (unchecked = extends RuntimeException;
if you must for some technical reason, but should be rare, and avoided),
it’s recommended to use a custom module specific checked exception
(checked = extends Exception);
which can wrap a caught RuntimeException, if needed.</p>
<p>In order to avoid proliferation of many kinds of checked Exception subtypes for
various particular nitty gritty things which could possibly go wrong, note that
it in ODL is perfectly OK &amp; recommended to have just ONE checked exception for a
small given functional ODL module (subsystem), and throw that from all of its
API methods.
This makes sense because a typical caller wouldn’t want do anything different -
what you are “bubbling up” is just that one of the operations which one module
asked another ODL module to do couldn’t be performed.
This avoids having multiple throws for each exception in API methods, and having
problems with extendibility due to having to add more exceptions to the “throws”
declaration of API methods.</p>
<p>The exception for “throws Exception” may be a main() method where it’s customary
to let anything propagate to the CLI, or <code class="docutils literal notranslate"><span class="pre">&#64;Test</span> <span class="pre">testSomething()</span> <span class="pre">throws</span> <span class="pre">Exception</span></code>
where it is acceptable (Checkstyle does NOT flag this particular use of
“throws Exception” in &#64;Test methods).</p>
</section>
<section id="illegalcatch">
<h4>IllegalCatch<a class="headerlink" href="#illegalcatch" title="Link to this heading">¶</a></h4>
<p>The <a class="reference external" href="https://checkstyle.sourceforge.net/config_coding.html#IllegalCatch">IllegalCatch</a>
violation should almost never be suppressed in regular “functional” code.
Normal code should only catch specific sub classes of the checked Exception,
and never any generic and/or unchecked exceptions.</p>
<p>In the old pre-Java 7 days, some people used “catch (Exception e)” to
“save typing” as a shorthand for having to catch a number of possibly thrown
types of checked exceptions declared with “throws” by a method within the try
block.
Nowadays, <a class="reference external" href="http://docs.oracle.com/javase/7/docs/technotes/guides/language/catch-multiple.html">since Java 7, using a multi-catch block</a>
is the right way to do this.
In addition to being “nicer” to read because it’s clearer, much more importantly
than, a multi-catch does not also accidentally catch RuntimeException, as catch
(Exception e) would.
Catching RuntimeException such as NullPointerException &amp; Co. is typically not
what the developer who used “catch (Exception e)” as shorthand intended.</p>
<p>If a catch (Exception e) is used after a try { } block which does not call any
methods declaring that they may throw checked exceptions with their throws
clause (perhaps not anymore, after code was changed), then that catch may really
have been intended to catch any possible RuntimeException instead?
In that case, if there exceptionally really is a particular reason to want to
“do something and recover from anything that could possibly go wrong, incl.
NullPointerException, IndexOutOfBoundsException, IllegalArgumentException,
IllegalStateException &amp; Co.”, then it is clearer to just catch
(RuntimeException e) instead of catch (Exception e).
Before doing this, double check that this truly is the intention of that code,
by having a closer look at code called within the try,
and see if that called code couldn’t simply be made more robust.
Be particularly careful with methods declaring checked exceptions in their
“throws” clause:
if any matching exception is thrown inside the “try” block, changing
“catch (Exception e)” to “catch (RuntimeException e)” could change the method
behavior since the exception will exit the method instead of being processed by
the “catch” block.</p>
<p>Proliferation of catch (Exception or RuntimeException e)
{ LOG.error(“It failed”, e); } in regular “functional” code is a symptom of a
missing abstraction in framework code; e.g. an Abstract interface implementation
helper with correct default error handling, so that functional code does
not have to repeat this over and over again.
For example:</p>
<ol class="arabic simple">
<li><p>For DataBroker related transaction management, check out the (at the time of
writing still in review) new utilities from
<a class="reference external" href="https://git.opendaylight.org/gerrit/#/c/63372/">c/63372</a> &amp; Co.</p></li>
<li><p>For RPC related catch, see
<a class="reference external" href="https://git.opendaylight.org/gerrit/#/c/63413/">c/63413</a></p></li>
<li><p>Instead of <code class="docutils literal notranslate"><span class="pre">catch(Exception)</span></code> after a <code class="docutils literal notranslate"><span class="pre">try</span> <span class="pre">{</span> <span class="pre">close(anAutoCloseable)</span> <span class="pre">}</span></code>
just use <code class="docutils literal notranslate"><span class="pre">AutoCloseables.closeOrWarn(anAutoCloseable)</span></code> introduced in
<a class="reference external" href="https://git.opendaylight.org/gerrit/#/c/44145/">https://git.opendaylight.org/gerrit/#/c/44145/</a></p></li>
</ol>
<p>Sometimes developers also simply don’t see that an existing framework API
intends implementations to simply propagate their errors up to them.
For example, for Exception handling in:</p>
<ol class="arabic simple">
<li><p>OsgiCommandSupport’s <code class="docutils literal notranslate"><span class="pre">doExecute()</span></code>, the right thing to do is… nothing.
The parent <code class="docutils literal notranslate"><span class="pre">doExecute()</span></code> method declaration throws Exception,
and that is intentional by the Good People of Karaf.
Therefore, <code class="docutils literal notranslate"><span class="pre">catch(Exception)</span></code> in a OsgiCommandSupport’s <code class="docutils literal notranslate"><span class="pre">doExecute</span></code> is not required
: in this case it’s perfectly OK to just let any error “propagate” upwards
automatically.
If <code class="docutils literal notranslate"><span class="pre">doExecute()</span></code> calls other private methods of an OsgiCommandSupport
implementation, then it is perfectly OK to make those methods declare
<code class="docutils literal notranslate"><span class="pre">&quot;throws</span> <span class="pre">SomeException&quot;</span></code> too, and not “handle” them yourself.</p></li>
<li><p>Callable’s <code class="docutils literal notranslate"><span class="pre">call()</span></code> passed to a <code class="docutils literal notranslate"><span class="pre">DataStoreJobCoordinator</span> <span class="pre">enqueueJob()</span></code>,
the right thing to do is… nothing.
Do not catch <code class="docutils literal notranslate"><span class="pre">(Exception)</span></code> but let it propagate.
If it’s useful to “augment” the exception message with more custom details
which are available inside Callable’s <code class="docutils literal notranslate"><span class="pre">call()</span></code>, then the right thing to do is
to <code class="docutils literal notranslate"><span class="pre">catch</span> <span class="pre">(Exception</span> <span class="pre">e)</span>
<span class="pre">{</span> <span class="pre">throw</span> <span class="pre">new</span> <span class="pre">YourProjectApiException(&quot;Failed</span> <span class="pre">to</span> <span class="pre">...</span> <span class="pre">for</span> <span class="pre">{}&quot;,</span> <span class="pre">aDetail,</span> <span class="pre">e);</span> <span class="pre">}</span></code>
and, exceptionally, use <code class="docutils literal notranslate"><span class="pre">&#64;SuppressWarnings(&quot;checkstyle:IllegalCatch&quot;)</span></code>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">org.opendaylight.infrautils.inject.AbstractLifecycle</span></code>’s start() and stop()
methods, again the right thing to do is… nothing.
Do not catch any Exception but let it propagate.</p></li>
</ol>
<p>Here are some cases where <code class="docutils literal notranslate"><span class="pre">catch(Exception)</span></code> is almost always wrong, and a
respective <code class="docutils literal notranslate"><span class="pre">&#64;SuppressWarnings</span></code> almost never acceptable:</p>
<ol class="arabic simple">
<li><p>In Tests code you typically just <code class="docutils literal notranslate"><span class="pre">&#64;Test</span> <span class="pre">testSomething()</span> <span class="pre">throws</span>
<span class="pre">(Some)Exception</span></code> instead of catch,
or uses <code class="docutils literal notranslate"><span class="pre">&#64;Test(expected</span> <span class="pre">=</span> <span class="pre">ReadFailedException.class)</span></code>.
One rare case we have seen where it’s justified is a
<code class="docutils literal notranslate"><span class="pre">&#64;Test(expected</span> <span class="pre">=</span> <span class="pre">ReadFailedException.class)</span></code>
with <code class="docutils literal notranslate"><span class="pre">catch</span> <span class="pre">(Exception</span> <span class="pre">e)</span> <span class="pre">throw</span> <span class="pre">e.getCause()</span></code>.</p></li>
<li><p>In one time “setup” (initialization) kind of code.
For example, catch for a <code class="docutils literal notranslate"><span class="pre">DataBroker</span> <span class="pre">registerDataChangeListener</span></code> makes little
sense - it’s typically much better to let a failure to register a data change
listener “bubble up” then continue, even if logged, and have users wonder why
the listener isn’t working much later.</p></li>
</ol>
<p>Only in lower-level “Framework” kind of code, catch (Exception e) is sometimes
justified / required,
and thus <code class="docutils literal notranslate"><span class="pre">&#64;SuppressWarnings(&quot;checkstyle:IllegalCatch&quot;)</span></code> acceptable.</p>
<p>Catching <code class="docutils literal notranslate"><span class="pre">Throwable</span></code> in particular is considered an absolute No No
(see e.g. discussion in <a class="reference external" href="https://git.opendaylight.org/gerrit/#/c/60855/">https://git.opendaylight.org/gerrit/#/c/60855/</a>)
in almost all cases.
You may got confused any meant to catch Exception (see above)
or RuntimeException?</p>
<p>Carefully consider whether you mean to catch and set some flag and/or
log, and then rethrow, or intended to “swallow” the exception.</p>
</section>
<section id="system-out">
<h4><code class="docutils literal notranslate"><span class="pre">System.out</span></code><a class="headerlink" href="#system-out" title="Link to this heading">¶</a></h4>
<p>The <code class="docutils literal notranslate"><span class="pre">RegexpSingleLineJava</span></code> “Line contains console output” and “Line contains
<code class="docutils literal notranslate"><span class="pre">printStackTrace</span></code>” should NEVER be suppressed.</p>
<p>In <code class="docutils literal notranslate"><span class="pre">src/main</span></code> code, <code class="docutils literal notranslate"><span class="pre">System.out.println</span></code> has no place, ever (it should probably be
a <code class="docutils literal notranslate"><span class="pre">LOG.info</span></code>; and <code class="docutils literal notranslate"><span class="pre">System.err</span></code> probably a <code class="docutils literal notranslate"><span class="pre">LOG.error</span></code>).</p>
<p>In Java code producing Karaf console output, we should only use <code class="docutils literal notranslate"><span class="pre">System.out</span></code>, and
add the corresponding <code class="docutils literal notranslate"><span class="pre">&#64;SuppressWarnings</span></code>. <code class="docutils literal notranslate"><span class="pre">System.out</span></code> handles pipes and remote
sessions correctly.</p>
<p>In <code class="docutils literal notranslate"><span class="pre">src/test</span></code> code, there should be no need to write things out - the point of a
test is to assert something.
During development of a test it is sometimes handy to print things to the console
to see what is going on instead of using the debugger, but this should be removed
in final code, for clarity, and non-verbose test execution.
If you must, do you a Logger even in a test - just like in <code class="docutils literal notranslate"><span class="pre">src/main</span></code> code.
This also makes it easier to later move code such as helper methods from test to
production code.</p>
</section>
<section id="javadoc-paragraph-p-tag-should-be-preceded-with-an-empty-line">
<h4>Javadoc Paragraph: &lt; p &gt; tag should be preceded with an empty line<a class="headerlink" href="#javadoc-paragraph-p-tag-should-be-preceded-with-an-empty-line" title="Link to this heading">¶</a></h4>
<p>Checkstyle (rightfully) flags this kind of JavaDoc up as not ideal for
readability:</p>
<div class="highlight-java notranslate"><div class="highlight"><pre><span></span><span class="o">/**</span>
<span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">Utilities</span><span class="w"> </span><span class="k">for</span><span class="p">...</span>
<span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="o">&lt;</span><span class="n">p</span><span class="o">&gt;</span><span class="n">This</span><span class="p">...</span>
</pre></div>
</div>
<p>and you can address this either like this:</p>
<div class="highlight-java notranslate"><div class="highlight"><pre><span></span><span class="o">/**</span>
<span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">Utilities</span><span class="w"> </span><span class="k">for</span><span class="p">...</span>
<span class="w"> </span><span class="o">*</span>
<span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="o">&lt;</span><span class="n">p</span><span class="o">&gt;</span><span class="n">This</span><span class="p">...</span>
</pre></div>
</div>
<p>or like this:</p>
<div class="highlight-java notranslate"><div class="highlight"><pre><span></span><span class="o">/**</span>
<span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">Utilities</span><span class="w"> </span><span class="k">for</span><span class="p">...</span>
<span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="o">&lt;</span><span class="n">p</span><span class="o">/&gt;</span>
<span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">This</span><span class="p">...</span>
</pre></div>
</div>
<p>Different ODL developers <a class="reference external" href="https://git.opendaylight.org/gerrit/#/c/46842/">agree to disagree</a>
on which of the above is more readable.</p>
</section>
</section>
<section id="additional-resources">
<h3>Additional Resources<a class="headerlink" href="#additional-resources" title="Link to this heading">¶</a></h3>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">Checkstyle</span></code>:
<a class="reference external" href="https://checkstyle.sourceforge.net">https://checkstyle.sourceforge.net</a></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">Maven</span></code>:
<a class="reference external" href="https://github.com/checkstyle/checkstyle/blob/master/src/main/resources/google_checks.xml">https://github.com/checkstyle/checkstyle/blob/master/src/main/resources/google_checks.xml</a></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">Eclipse</span></code>:
<a class="reference external" href="https://github.com/google/styleguide/blob/gh-pages/eclipse-java-google-style.xml">https://github.com/google/styleguide/blob/gh-pages/eclipse-java-google-style.xml</a></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">IntelliJ</span></code>:
<a class="reference external" href="https://github.com/google/styleguide/blob/gh-pages/intellij-java-google-style.xml">https://github.com/google/styleguide/blob/gh-pages/intellij-java-google-style.xml</a></p></li>
<li><p><a class="reference external" href="https://wiki-archive.opendaylight.org/view/How_to_set_Checkstyle_up_in_IntelliJ">How to set Checkstyle up in IntelliJ old wiki page</a></p></li>
</ul>
</section>
</section>
<section id="classes-methods-fields-ordering">
<h2>Classes methods / fields ordering<a class="headerlink" href="#classes-methods-fields-ordering" title="Link to this heading">¶</a></h2>
<p>Ordering based on modifiers. This is based on visibility and mutability:</p>
<div class="line-block">
<div class="line">public static final fields</div>
<div class="line">static final fields</div>
<div class="line">private static final fields</div>
<div class="line">private final fields</div>
<div class="line">private non-final fields</div>
<div class="line">private volatile fields</div>
<div class="line">private constructors</div>
<div class="line">public constructors</div>
<div class="line">static factory methods</div>
<div class="line">public methods</div>
<div class="line">static methods</div>
<div class="line">private methods</div>
<div class="line">The first group should be very strict, with the exception of
FieldUpdaters, which should be private static final, but defined just
above the volatile field they access. The reason for that is they are
tied via a string literal name.</div>
</div>
<p>The second group is less clear-cut and depends on how instances are created –
there are times when juggling the order makes it easier to understand what is
going on (e.g. co-locating a private static method with static factory method
which uses it).</p>
<p>The third group is pretty much free-for-all.
The goal is to group things so that people do not have scroll around to
understand the code flow.
Public methods are obviously entry-points,
hence are mostly glanced over by users.</p>
<p>For readability, keep each of the above field groups together and separate groups by exactly <em>one empty line</em>.
Avoid interleaving unrelated fields across groups (e.g., mixing <code class="docutils literal notranslate"><span class="pre">private</span> <span class="pre">final</span></code> and <code class="docutils literal notranslate"><span class="pre">private</span> <span class="pre">volatile</span></code> fields).</p>
<p>Overall this has worked really well so far because;</p>
<ul class="simple">
<li><p>the first group gives a 10000-foot overview of what is going on in the class,
its footprint and references to other classes</p></li>
<li><p>the second group gives instantiation entry-points, useful for examining who
creates the objects and how</p></li>
<li><p>the third group is implementation details – for when you really need to dive
into the details.</p></li>
</ul>
<p>Note this list does not include non-private fields.
The reason is that public fields should be forbidden, as should be any mutable
non-private fields.
The reason for that is they are a nightmare to navigate when attempting to
reason about object life-cycle.</p>
<p>Same reasoning applies to inner class, keep them close to the methods which use
them so that the class is easy to read.
If the inner class needs to be understood before the methods that operate on it,
place it before them, otherwise (especially if it’s an implementation detail)
after them.
That’s when an inner class is appropriate of course.</p>
</section>
<section id="error-prone">
<h2>error-prone<a class="headerlink" href="#error-prone" title="Link to this heading">¶</a></h2>
<p>The infrautils projects has adopted the <a class="reference external" href="http://errorprone.info">error-prone code quality tool</a>
(by Google), with suitable customized configuration.</p>
<p>You can use it by using <code class="docutils literal notranslate"><span class="pre">org.opendaylight.infrautils:parent</span></code> instead of
<code class="docutils literal notranslate"><span class="pre">org.opendaylight.odlparent:bundle-parent</span></code>.</p>
<p>Note that <code class="docutils literal notranslate"><span class="pre">&#64;SuppressWarnings(&quot;InconsistentOverloads&quot;)</span></code> needs to be placed on the
class, not method; see
<a class="reference external" href="https://github.com/google/error-prone/pull/870">https://github.com/google/error-prone/pull/870</a> and
<a class="reference external" href="https://github.com/google/error-prone/issues/869">https://github.com/google/error-prone/issues/869</a>.</p>
</section>
<section id="spotbugs">
<h2>SpotBugs<a class="headerlink" href="#spotbugs" title="Link to this heading">¶</a></h2>
<p>SpotBugs is the successor project to FindBugs (which is dead).</p>
<p>SpotBugs is enforced by default across all artifacts since Magnesium.
For artifacts that do not pass SpotBugs, either fix them or disable enforcement
by defining the following property in the pom.xml:</p>
<blockquote>
<div><div class="highlight-none notranslate"><div class="highlight"><pre><span></span>&lt;properties&gt;
 &lt;odlparent.spotbugs.enforce&gt;false&lt;/odlparent.spotbugs.enforce&gt;
&lt;/properties&gt;
</pre></div>
</div>
</div></blockquote>
<p>All notes re. FindBugs listed below do still apply to SpotBugs as well
(it’s compatible).</p>
</section>
<section id="findbugs">
<h2>FindBugs<a class="headerlink" href="#findbugs" title="Link to this heading">¶</a></h2>
<p>Note that starting with odlparent 3.0.0 when we say “FindBugs” we now actually
mean “SpotBugs”, see above.</p>
<section id="fbsuppresswarnings">
<h3><code class="docutils literal notranslate"><span class="pre">&#64;FBSuppressWarnings</span></code><a class="headerlink" href="#fbsuppresswarnings" title="Link to this heading">¶</a></h3>
<p>If really needed, projects can to override individual FindBugs rules on
a case-by-case basis by using a <code class="docutils literal notranslate"><span class="pre">&#64;SuppressFBWarnings</span></code> annotation:</p>
<div class="highlight-java notranslate"><div class="highlight"><pre><span></span><span class="nd">@SuppressFBWarnings</span><span class="p">(</span><span class="s">&quot;RCN_REDUNDANT_NULLCHECK_OF_NONNULL_VALUE&quot;</span><span class="p">)</span>
<span class="kd">public</span><span class="w"> </span><span class="n">V</span><span class="w"> </span><span class="nf">get</span><span class="p">(</span><span class="n">K</span><span class="w"> </span><span class="n">key</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</pre></div>
</div>
</section>
<section id="unchecked-unconfirmed-cast-from-com-google-common-truth-subject-to-com-google-common-truth-booleansubject-etc">
<h3>Unchecked/unconfirmed cast from <code class="docutils literal notranslate"><span class="pre">com.google.common.truth.Subject</span></code> to <code class="docutils literal notranslate"><span class="pre">com.google.common.truth.BooleanSubject</span></code> etc.<a class="headerlink" href="#unchecked-unconfirmed-cast-from-com-google-common-truth-subject-to-com-google-common-truth-booleansubject-etc" title="Link to this heading">¶</a></h3>
<p>FindBugs seems to be too dumb to deal with perfectly valid Google Truth test
code (which does not use any explicit cast…) so it’s OK to:</p>
<div class="highlight-java notranslate"><div class="highlight"><pre><span></span><span class="nd">@SuppressFBWarnings</span><span class="p">(</span><span class="s">&quot;BC_UNCONFIRMED_CAST&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>an entire JUnit *Test class because of that.</p>
</section>
<section id="null-analysis-errors-incl-findbugs-np-nonnull-field-not-initialized-in-constructor">
<h3>null analysis errors, incl. FindBugs’ NP_NONNULL_FIELD_NOT_INITIALIZED_IN_CONSTRUCTOR<a class="headerlink" href="#null-analysis-errors-incl-findbugs-np-nonnull-field-not-initialized-in-constructor" title="Link to this heading">¶</a></h3>
<p>see the general null analysis next chapter.</p>
<section id="nonnullandoptional">
<h4><code class="docutils literal notranslate"><span class="pre">nonNullAndOptional</span></code><a class="headerlink" href="#nonnullandoptional" title="Link to this heading">¶</a></h4>
<p>Some of the content from this chapter may be moved to
<a class="reference external" href="http://www.lastnpe.org">http://www.lastnpe.org</a> later…</p>
</section>
</section>
<section id="everything-nonnullbydefault">
<h3>Everything <code class="docutils literal notranslate"><span class="pre">&#64;NonNullByDefault</span></code><a class="headerlink" href="#everything-nonnullbydefault" title="Link to this heading">¶</a></h3>
<p>Do not use null anywhere, assume all method arguments and return values are
<code class="docutils literal notranslate"><span class="pre">NonNullByDefault</span></code>.</p>
</section>
<section id="null-annotations-from-org-eclipse-jdt-annotation-instead-of-javax-annotation">
<h3>null annotations from <code class="docutils literal notranslate"><span class="pre">org.eclipse.jdt.annotation</span></code> instead of <code class="docutils literal notranslate"><span class="pre">javax.annotation</span></code><a class="headerlink" href="#null-annotations-from-org-eclipse-jdt-annotation-instead-of-javax-annotation" title="Link to this heading">¶</a></h3>
<p>We prefer using the null annotations from the package <code class="docutils literal notranslate"><span class="pre">org.eclipse.jdt.annotation</span></code>
, instead of the ones from <code class="docutils literal notranslate"><span class="pre">javax.annotation</span></code>
(or those from <code class="docutils literal notranslate"><span class="pre">org.jetbrains:annotations</span></code>, or … <code class="docutils literal notranslate"><span class="pre">Android</span></code>/<code class="docutils literal notranslate"><span class="pre">Lombok's</span></code>/some of the
other ones out there).</p>
<p>This is because the org.eclipse one are modern generics enabled &#64;Target
TYPE_USE annotations, whereas the other ones are not.</p>
<p>Obviously we do NOT “depend on Eclipse” in any way, or “need Eclipse at
run-time” just because of 4 annotations from an org.eclipse package,
which are available in a very small JAR at build-time; e.g.
<code class="docutils literal notranslate"><span class="pre">org.eclipse.jdt.annotation.NonNull</span></code> is absolutely no different from
<code class="docutils literal notranslate"><span class="pre">javax.annotation.Nullable</span></code>, in that regard.</p>
<p>BTW: The <code class="docutils literal notranslate"><span class="pre">javax.annotation</span> <span class="pre">NonNull</span></code> &amp; Co. are not more or less “official”
than others; Prof. FindBugs Bill Pugh pushed those to Maven central, but
his “dormant” JSR 305 was never officially finalized and approved;
he’s since moved on, and no longer maintains FindBugs.</p>
<p>The Eclipse annotations are also supported by SpotBugs/FindBugs (<a class="reference external" href="https://github.com/spotbugs/spotbugs/issues/471">says
this issue</a>) as well
as NullAway.</p>
</section>
<section id="null-analysis-by-findbugs-vs-eclipse-jdt">
<h3>null analysis by FindBugs VS. Eclipse JDT<a class="headerlink" href="#null-analysis-by-findbugs-vs-eclipse-jdt" title="Link to this heading">¶</a></h3>
<p>FindBugs’ null analysis is inferior to Eclipse JDT’s, because:</p>
<ul class="simple">
<li><p>richer null analysis</p></li>
<li><p>generics enabled (see above)</p></li>
<li><p>works with existing external libraries, through external annotations,
see <a class="reference external" href="http://www.lastnpe.org">http://www.lastnpe.org</a></p></li>
<li><p>much better in-IDE support, at least for Eclipse users</p></li>
</ul>
<p><em>WIP: We are aiming at, eventually, running headless Eclipse JDT-based null
analysis during the build, not just for users of the Eclipse IDE UI;
watch</em><a class="reference external" href="https://jira.opendaylight.org/browse/ODLPARENT-116">issue ODLPARENT-116</a>
<em>, and</em><a class="reference external" href="http://www.lastnpe.org">http://www.lastnpe.org</a><em>.</em></p>
<p>BTW: FindBugs is dead anyway, long live SpotBugs! _TODO Gerrit &amp; more
documentation to clarify this…_</p>
<p>PS: An alternative interesting null checker tool is the <a class="reference external" href="https://checkerframework.org">Checker
Framework</a>.</p>
</section>
<section id="runtime-null-checks">
<h3>Runtime null checks<a class="headerlink" href="#runtime-null-checks" title="Link to this heading">¶</a></h3>
<p>In addition to static null analysis during development, you can check null
safety at run-time.
Please use either <a class="reference external" href="http://docs.oracle.com/javase/7/docs/api/java/util/Objects.html#requireNonNull(java.lang.Object,java.lang.String)">JDK’s Object’s requireNonNull</a>
() or <a class="reference external" href="https://github.com/google/guava/wiki/PreconditionsExplained">Guava’s
Preconditions</a>
<code class="docutils literal notranslate"><span class="pre">checkNotNull()</span></code> utility, instead of if (something == null).
Please also use the variant of <code class="docutils literal notranslate"><span class="pre">requireNonNull()</span></code> or <code class="docutils literal notranslate"><span class="pre">checkNotNull()</span></code> with the
String message to indicate what argument is checked.
For example:</p>
<div class="highlight-java notranslate"><div class="highlight"><pre><span></span><span class="kd">public</span><span class="w"> </span><span class="nf">doSomething</span><span class="p">(</span><span class="n">Something</span><span class="w"> </span><span class="n">something</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">this</span><span class="p">.</span><span class="na">something</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Objects</span><span class="p">.</span><span class="na">requireNonNull</span><span class="p">(</span><span class="n">something</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;something&quot;</span><span class="p">);</span>
<span class="p">}</span>
</pre></div>
</div>
<p>We recommend use of JDK’s Object’s <code class="docutils literal notranslate"><span class="pre">requireNonNull()</span></code> instead of Guava’s
Preconditions <code class="docutils literal notranslate"><span class="pre">checkNotNull()</span></code> just because the String message of the former can
prevent the problem you can have with the latter if you confuse the order of the
arguments.</p>
<p>We accept and think its OK that <code class="docutils literal notranslate"><span class="pre">checkNotNull()</span></code> throws a NullPointerException and
not an IllegalArgumentException (even though code otherwise should never
manually throw new NullPointerException),
because in this particular case a NullPointerException would have happened
anyway later, so it’s just an earlier NullPointerException, with added
information of what is null.</p>
<p>We NEVER catch (NullPointerException e) anywhere, because they are programming
errors which should “bubble up”, to be fixed, not suppressed.</p>
</section>
<section id="nullable-errors-for-fields-related-to-dependency-injection">
<h3><code class="docutils literal notranslate"><span class="pre">nullable</span></code> errors for fields related to dependency injection<a class="headerlink" href="#nullable-errors-for-fields-related-to-dependency-injection" title="Link to this heading">¶</a></h3>
<p>null analysis frameworks, such as Eclipse’s or FindBugs or other, will not like
this kind of code in a <code class="docutils literal notranslate"><span class="pre">&#64;NonNullByDefault</span></code> package:</p>
<div class="highlight-java notranslate"><div class="highlight"><pre><span></span><span class="kd">class</span> <span class="nc">Example</span><span class="w"> </span><span class="p">{</span>
<span class="w">     </span><span class="nd">@Inject</span>
<span class="w">     </span><span class="n">Service</span><span class="w"> </span><span class="n">s</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</div>
<p>the recommended solution is to always use constructor instead of field
injection instead, like this:</p>
<div class="highlight-java notranslate"><div class="highlight"><pre><span></span><span class="kd">class</span> <span class="nc">Example</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="kd">final</span><span class="w"> </span><span class="n">Service</span><span class="w"> </span><span class="n">s</span><span class="p">;</span>
<span class="w">    </span><span class="nd">@Inject</span>
<span class="w">    </span><span class="n">Example</span><span class="p">(</span><span class="n">Service</span><span class="w"> </span><span class="n">s</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="k">this</span><span class="p">.</span><span class="na">s</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">s</span><span class="p">;</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<p>When this exceptionally is not possible, like in a JUnit component test,
then it’s acceptable to suppress warnings:</p>
<div class="highlight-java notranslate"><div class="highlight"><pre><span></span><span class="nd">@SuppressFBWarnings</span><span class="p">(</span><span class="s">&quot;NP_NONNULL_FIELD_NOT_INITIALIZED_IN_CONSTRUCTOR&quot;</span><span class="p">)</span>
<span class="kd">class</span> <span class="nc">SomeTest</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="nd">@Rule</span><span class="w"> </span><span class="n">GuiceRule</span><span class="w"> </span><span class="n">guice</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">GuiceRule</span><span class="p">(</span><span class="n">TestModule</span><span class="p">.</span><span class="na">class</span><span class="p">);</span>
<span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="nd">@Inject</span><span class="w"> </span><span class="n">Service</span><span class="w"> </span><span class="n">service</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</div>
</section>
<section id="optional">
<h3>Optional<a class="headerlink" href="#optional" title="Link to this heading">¶</a></h3>
<p>You do not have to use Optional, because real null analysis can give us the same
benefit.</p>
<p>If cleaning up code for null safety, then do not mix introducing Optional with
other null related clean up changes; it’s clearer for reviews if you FIRST fix
missing null checks and add null related annotations, and then THEN (optionally)
switch some return types to Optional.</p>
<p>You can use Optional for return types, but not method arguments.</p>
<p>Never use <code class="docutils literal notranslate"><span class="pre">Optional&lt;Collection&lt;...&gt;&gt;</span></code> (obviously incl. <code class="docutils literal notranslate"><span class="pre">Optional&lt;List&lt;...&gt;&gt;</span></code>
or <code class="docutils literal notranslate"><span class="pre">Optional&lt;Set&lt;...&gt;&gt;</span></code> AND <code class="docutils literal notranslate"><span class="pre">Optional&lt;Map&lt;...&gt;&gt;</span></code> etc.),
just return a respective empty Collection instead.</p>
<p>Note that instead of if <code class="docutils literal notranslate"><span class="pre">(anOptional.isPresent())</span> <span class="pre">{</span> <span class="pre">return</span> <span class="pre">anOptional.get();</span> <span class="pre">}</span>
<span class="pre">else</span> <span class="pre">{</span> <span class="pre">return</span> <span class="pre">null;</span> <span class="pre">}</span></code>
you can and for readability should just use return <code class="docutils literal notranslate"><span class="pre">anOptional.orNull()</span></code>.
However ideally any such code should not return null but an Optional of
something itself.</p>
<p>Note that instead of <code class="docutils literal notranslate"><span class="pre">if</span> <span class="pre">(aNullable</span> <span class="pre">==</span> <span class="pre">null)</span> <span class="pre">?</span> <span class="pre">Optional.absent()</span> <span class="pre">:</span>
<span class="pre">Optional.of(aNullable)a</span></code>
;you can and for readability should just use <code class="docutils literal notranslate"><span class="pre">Optional.fromNullable(aNullable)</span></code>.</p>
<p>To transform an Optional into something else if it present, use the transform()
method instead of an if () check;.
for example:</p>
<div class="highlight-java notranslate"><div class="highlight"><pre><span></span><span class="n">List</span><span class="w"> </span><span class="n">vrfEntries</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">MDSALUtil</span><span class="p">.</span><span class="na">read</span><span class="p">(</span><span class="n">broker</span><span class="p">,</span><span class="w"> </span><span class="n">LogicalDatastoreType</span><span class="p">.</span><span class="na">CONFIGURATION</span><span class="p">,</span><span class="w"> </span><span class="n">vpnVrfTables</span><span class="p">).</span><span class="na">transform</span><span class="p">(</span><span class="n">VrfTables</span><span class="p">::</span><span class="n">getVrfEntry</span><span class="p">).</span><span class="na">or</span><span class="p">(</span><span class="k">new</span><span class="w"> </span><span class="n">ArrayList</span><span class="o">&lt;&gt;</span><span class="p">());</span>
</pre></div>
</div>
<p><strong>Take care</strong> with <code class="docutils literal notranslate"><span class="pre">Optional.transform()</span></code> though: if the transformation can return
null, <code class="docutils literal notranslate"><span class="pre">Optional.transform()</span></code> will fail with a NullPointerException
(this is the case of most YANG-generated methods).
You can use Java 8 <code class="docutils literal notranslate"><span class="pre">Optional.map()</span></code> instead; when it encounters null, it returns
<code class="docutils literal notranslate"><span class="pre">Optional.empty()</span></code>.
The above example would become</p>
<div class="highlight-java notranslate"><div class="highlight"><pre><span></span><span class="n">List</span><span class="o">&lt;</span><span class="n">VrfEntry</span><span class="o">&gt;</span><span class="w"> </span><span class="n">vrfEntries</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">MDSALUtil</span><span class="p">.</span><span class="na">read</span><span class="p">(</span><span class="n">broker</span><span class="p">,</span><span class="w"> </span><span class="n">LogicalDatastoreType</span><span class="p">.</span><span class="na">CONFIGURATION</span><span class="p">,</span><span class="w"> </span><span class="n">vpnVrfTables</span><span class="p">).</span><span class="na">toJavaUtil</span><span class="p">().</span><span class="na">map</span><span class="p">(</span><span class="n">VrfTables</span><span class="p">::</span><span class="n">getVrfEntry</span><span class="p">).</span><span class="na">orElse</span><span class="p">(</span><span class="k">new</span><span class="w"> </span><span class="n">ArrayList</span><span class="o">&lt;&gt;</span><span class="p">());</span>
</pre></div>
</div>
<p>Prefer the newer Java 8 <code class="docutils literal notranslate"><span class="pre">java.util.Optional</span></code> (JUO) over the older Google Guava
<code class="docutils literal notranslate"><span class="pre">com.google.common.base.Optional</span></code> (GGO), because it offers a better functional
style API for use with Java 8 lambdas, which leads to much more naturally
readable code.
Until we fully migrate all ODL APIs (which is planned), in glue code calling
existing APIs returning GGO (such as the DataBroker API) but itself then wanting
to return a function of that as JUO, please just use the <code class="docutils literal notranslate"><span class="pre">toJavaUtil()</span></code> method
available in Guava Optional.</p>
<section id="further-reading-watching">
<h4>Further Reading &amp; Watching<a class="headerlink" href="#further-reading-watching" title="Link to this heading">¶</a></h4>
<ul class="simple">
<li><p><a class="reference external" href="https://github.com/google/guava/wiki/UsingAndAvoidingNullExplained">https://github.com/google/guava/wiki/UsingAndAvoidingNullExplained</a></p></li>
<li><p><a class="reference external" href="https://stackoverflow.com/questions/26327957/should-java-8-getters-return-optional-type">https://stackoverflow.com/questions/26327957/should-java-8-getters-return-optional-type</a></p></li>
</ul>
</section>
</section>
</section>
<section id="streaming-and-lambdas">
<h2>Streaming and lambdas<a class="headerlink" href="#streaming-and-lambdas" title="Link to this heading">¶</a></h2>
<p>Lambdas are very useful when encapsulating varying behavior.
For example, you can use them instead of boolean behavior selection parameters:</p>
<div class="highlight-java notranslate"><div class="highlight"><pre><span></span><span class="kd">public</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">someMethodA</span><span class="p">(</span><span class="n">SomeObject</span><span class="w"> </span><span class="n">A</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">commonMethod</span><span class="p">(</span><span class="n">A</span><span class="p">,</span><span class="w"> </span><span class="kc">false</span><span class="p">);</span>
<span class="p">}</span>

<span class="kd">public</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">someMethodB</span><span class="p">(</span><span class="n">SomeObject</span><span class="w"> </span><span class="n">B</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">commonMethod</span><span class="p">(</span><span class="n">B</span><span class="p">,</span><span class="w"> </span><span class="kc">true</span><span class="p">);</span>
<span class="p">}</span>

<span class="kd">private</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">commonMethod</span><span class="p">(</span><span class="n">SomeObject</span><span class="w"> </span><span class="n">C</span><span class="p">,</span><span class="w"> </span><span class="kt">boolean</span><span class="w"> </span><span class="n">behaviour</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="c1">// common code</span>

<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">behaviour</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="n">doA</span><span class="p">();</span>
<span class="w">    </span><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="n">doB</span><span class="p">();</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="c1">// common code</span>
<span class="p">}</span>
</pre></div>
</div>
<p>can be replaced with</p>
<div class="highlight-java notranslate"><div class="highlight"><pre><span></span><span class="kd">public</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">someMethodA</span><span class="p">(</span><span class="n">SomeObject</span><span class="w"> </span><span class="n">A</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">commonMethod</span><span class="p">(</span><span class="n">A</span><span class="p">,</span><span class="w"> </span><span class="k">this</span><span class="p">::</span><span class="n">doA</span><span class="p">);</span>
<span class="p">}</span>

<span class="kd">public</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">someMethodB</span><span class="p">(</span><span class="n">SomeObjectB</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">commonMethod</span><span class="p">(</span><span class="n">B</span><span class="p">,</span><span class="w"> </span><span class="k">this</span><span class="p">::</span><span class="n">doB</span><span class="p">);</span>
<span class="p">}</span>

<span class="kd">private</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">commonMethod</span><span class="p">(</span><span class="n">SomeObject</span><span class="w"> </span><span class="n">C</span><span class="p">,</span><span class="w"> </span><span class="n">Function</span><span class="w"> </span><span class="n">behaviour</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="c1">// common code</span>

<span class="w">    </span><span class="n">behaviour</span><span class="p">.</span><span class="na">apply</span><span class="p">();</span>

<span class="w">    </span><span class="c1">// common code</span>
<span class="p">}</span>
</pre></div>
</div>
<p>They are also useful for replacing small anonymous inner classes which follow
the functional pattern (implementing an interface with a single non-default
method).
Your IDE will typically suggest such transformations.</p>
<p>Lambdas should be avoided when the resulting code is more complex and/or longer
than the non-functional form.
This can happen particularly with streaming.</p>
<p>Streaming also has its place, especially when combined with Optional (see above)
or when processing collections.
It should however be avoided when many objects are created in the resulting
lambda expressions, especially if DTOs end up being necessary to convey
information from one lambda to the next where a single variable could do the
trick in a more traditional form. (TODO: provide examples.)</p>
</section>
<section id="pre-review-guidance">
<h2>Pre-review guidance<a class="headerlink" href="#pre-review-guidance" title="Link to this heading">¶</a></h2>
<p>When submitting changes, ensure the related ODL JIRA has correct status and a clear description
(scope, motivation, acceptance criteria). Keep commit messages consistent with:
<a class="reference external" href="https://cbea.ms/git-commit/">https://cbea.ms/git-commit/</a></p>
<p>Before sending a patch for review, ensure:</p>
<ul class="simple">
<li><p>unit test coverage of the behavior change (add/update tests where needed)</p></li>
<li><p>classes and methods Javadoc are updated when public APIs or behavior changes</p></li>
<li><p>avoid adding new third-party dependencies unless there is strong justification and consensus</p></li>
<li><p>keep dependencies and plugins alphabetically sorted in <code class="docutils literal notranslate"><span class="pre">pom.xml</span></code></p></li>
<li><p>keep changes API-compatible: avoid partial changes which require follow-up patches to be correct</p></li>
<li><p>eliminate deprecation warnings as much as possible; do not introduce any new deprecation without a plan</p></li>
<li><p>keep one logical change per patch; split unrelated fixes/refactors into separate changes</p></li>
</ul>
</section>
</section>


    </div>
      
  </div>
</div>

<footer class="footer">
  <div class="container">
    <p class="pull-right">
      <a href="#">Back to top</a>
      
        <br/>
        
<div id="sourcelink">
  <a href="../../_sources/contributor-guides/coding-guidelines/coding-guidelines-java.rst.txt"
     rel="nofollow">Source</a>
</div>
      
    </p>
    <p>
        &copy; Copyright 2016-2026, OpenDaylight Project.<br/>
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 8.2.3.<br/>
    </p>
  </div>
</footer>
  </body>
</html>