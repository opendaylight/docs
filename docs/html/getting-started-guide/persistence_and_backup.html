
<!DOCTYPE html>

<html lang="en" data-content_root="../">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Persistence and Backup &#8212; OpenDaylight Documentation Chromium documentation</title>
    <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=03e43079" />
    <link rel="stylesheet" type="text/css" href="../_static/bootstrap-sphinx.css?v=0bf093e7" />
    <link rel="stylesheet" type="text/css" href="../_static/graphviz.css?v=4ae1632d" />
    <link rel="stylesheet" type="text/css" href="https://cdn.datatables.net/1.11.2/css/jquery.dataTables.min.css" />
    <link rel="stylesheet" type="text/css" href="../_static/css/ribbon.css?v=cb953b18" />
    <link rel="stylesheet" href="../_static/css/warning-header.css" type="text/css" />
    <script src="../_static/documentation_options.js?v=7b4a4459"></script>
    <script src="../_static/doctools.js?v=9bcbadda"></script>
    <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="https://cdn.datatables.net/1.11.2/js/jquery.dataTables.min.js"></script>
    <script class="init" type="text/javascript">$(document).ready( function () { $('table.datatable').DataTable(); } );</script>
    <link rel="icon" href="../_static/favicon.ico"/>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Security Considerations" href="security_considerations.html" />
    <link rel="prev" title="Setting Up Clustering" href="clustering.html" />
<meta charset='utf-8'>
<meta http-equiv='X-UA-Compatible' content='IE=edge,chrome=1'>
<meta name='viewport' content='width=device-width, initial-scale=1.0, maximum-scale=1'>
<meta name="apple-mobile-web-app-capable" content="yes">
<script type="text/javascript" src="../_static/js/jquery-1.12.4.min.js"></script>
<script type="text/javascript" src="../_static/js/jquery-fix.js"></script>
<script type="text/javascript" src="../_static/bootstrap-3.4.1/js/bootstrap.min.js"></script>
<script type="text/javascript" src="../_static/bootstrap-sphinx.js"></script>

  </head><body>
  <div class="ribbon">
    <a href="https://jira.opendaylight.org/secure/CreateIssueDetails!init.jspa
?pid=10121
&issuetype=10104
&components=10228
&priority=2
&description=version:+Chromium%0Apage:+getting-started-guide/persistence_and_backup%0A%0A" target="_blank">
      Report Issue
    </a>
  </div>
  

<div id="navbar" class="navbar navbar-default navbar-fixed-top">
  <!-- Outdated version warning banner -->
  
    <style>
      body {
        padding-top: 60px;
     }
    </style>
  
    <div class="container">
      <div class="navbar-header">
        <!-- .btn-navbar is used as the toggle for collapsed navbar content -->
        <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".nav-collapse">
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
        </button>
        <a class="navbar-brand" href="../index.html">
          OpenDaylight Documentation</a>
        <span class="navbar-text navbar-version pull-left"><b>Chromium</b></span>
      </div>

        <div class="collapse navbar-collapse nav-collapse">
          <ul class="nav navbar-nav">
            
            
              <li class="dropdown globaltoc-container">
  <a role="button"
     id="dLabelGlobalToc"
     data-toggle="dropdown"
     data-target="#"
     href="../index.html">Site <b class="caret"></b></a>
  <ul class="dropdown-menu globaltoc"
      role="menu"
      aria-labelledby="dLabelGlobalToc"><ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../downloads.html">OpenDaylight Downloads</a></li>
<li class="toctree-l1"><a class="reference internal" href="../release-notes/index.html">Release Notes</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="index.html">Getting Started Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../developer-guides/index.html">Developer Guides</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../documentation.html">Documentation Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../release-process/index.html">OpenDaylight Release Process Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../javadoc.html">Java API Documentation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../user-guide/index.html">OpenDaylight User Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../developer-guides/index.html">Developer Guides</a></li>
<li class="toctree-l1"><a class="reference internal" href="../contributor-guides/index.html">Contributor Guides</a></li>
</ul>
</ul>
</li>
              
                <li class="dropdown">
  <a role="button"
     id="dLabelLocalToc"
     data-toggle="dropdown"
     data-target="#"
     href="#">Page <b class="caret"></b></a>
  <ul class="dropdown-menu localtoc"
      role="menu"
      aria-labelledby="dLabelLocalToc"><ul>
<li><a class="reference internal" href="#">Persistence and Backup</a><ul>
<li><a class="reference internal" href="#set-persistence-script">Set Persistence Script</a></li>
<li><a class="reference internal" href="#backing-up-and-restoring-the-datastore">Backing Up and Restoring the Datastore</a></li>
</ul>
</li>
</ul>
</ul>
</li>
              
            
            
            
            
            
          </ul>

          
            
<form class="navbar-form navbar-right" action="../search.html" method="get">
 <div class="form-group">
  <input type="text" name="q" class="form-control" placeholder="Search" />
 </div>
  <input type="hidden" name="check_keywords" value="yes" />
  <input type="hidden" name="area" value="default" />
</form>
          
        </div>
    </div>
  </div>

<div class="container">
  <div class="row">
      <div class="col-md-3">
        <div id="sidebar" class="bs-sidenav" role="complementary"><ul>
<li><a class="reference internal" href="#">Persistence and Backup</a><ul>
<li><a class="reference internal" href="#set-persistence-script">Set Persistence Script</a></li>
<li><a class="reference internal" href="#backing-up-and-restoring-the-datastore">Backing Up and Restoring the Datastore</a></li>
</ul>
</li>
</ul>
<center>
<div class="btn-group" role="group" aria-label="...">
    
    <a class="btn btn-default" href="clustering.html">Prev Page</a>
    

    
    <a class="btn btn-default" href="security_considerations.html">Next Page</a>
    
</div>
</center>
        </div>
      </div>
    <div class="body col-md-9 content" role="main">
      
  <section id="persistence-and-backup">
<h1>Persistence and Backup<a class="headerlink" href="#persistence-and-backup" title="Link to this heading">¶</a></h1>
<section id="set-persistence-script">
<h2>Set Persistence Script<a class="headerlink" href="#set-persistence-script" title="Link to this heading">¶</a></h2>
<p>This script is used to enable or disable the config datastore persistence. The
default state is enabled but there are cases where persistence may not be
required or even desired. The user should restart the node to apply the changes.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The script can be used at any time, even before the controller is started
for the first time.</p>
</div>
<p>Usage:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>bin/set_persistence.sh<span class="w"> </span>&lt;on/off&gt;
</pre></div>
</div>
<p>Example:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>bin/set_persistence.sh<span class="w"> </span>off
</pre></div>
</div>
<p>The above command will disable the config datastore persistence.</p>
</section>
<section id="backing-up-and-restoring-the-datastore">
<span id="cluster-backup-restore"></span><h2>Backing Up and Restoring the Datastore<a class="headerlink" href="#backing-up-and-restoring-the-datastore" title="Link to this heading">¶</a></h2>
<p>The same cluster-admin API described in the <a class="reference internal" href="clustering.html#cluster-admin-api"><span class="std std-ref">cluster guide</span></a>
for managing shard voting states has an RPC allowing backup of the datastore in a single
node, taking only the file name as a parameter:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">POST</span>  <span class="o">/</span><span class="n">restconf</span><span class="o">/</span><span class="n">operations</span><span class="o">/</span><span class="n">cluster</span><span class="o">-</span><span class="n">admin</span><span class="p">:</span><span class="n">backup</span><span class="o">-</span><span class="n">datastore</span>

<span class="ow">or</span>

<span class="n">POST</span>  <span class="o">/</span><span class="n">rests</span><span class="o">/</span><span class="n">operations</span><span class="o">/</span><span class="n">cluster</span><span class="o">-</span><span class="n">admin</span><span class="p">:</span><span class="n">backup</span><span class="o">-</span><span class="n">datastore</span>
</pre></div>
</div>
<p>RPC input JSON:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
  <span class="s2">&quot;input&quot;</span><span class="p">:</span> <span class="p">{</span>
    <span class="s2">&quot;file-path&quot;</span><span class="p">:</span> <span class="s2">&quot;/tmp/datastore_backup&quot;</span>
  <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This backup can only be restored if the YANG models of the backed-up data
are identical in the backup OpenDaylight instance and restore target
instance.</p>
</div>
<p>To restore the backup on the target node the file needs to be placed into the
<code class="docutils literal notranslate"><span class="pre">$KARAF_HOME/clustered-datastore-restore</span></code> directory, and then the node
restarted. If the directory does not exist (which is quite likely if this is a
first-time restore) it needs to be created. On startup, ODL checks if the
<code class="docutils literal notranslate"><span class="pre">journal</span></code> and <code class="docutils literal notranslate"><span class="pre">snapshots</span></code> directories in <code class="docutils literal notranslate"><span class="pre">$KARAF_HOME</span></code> are empty, and
only then tries to read the contents of the <code class="docutils literal notranslate"><span class="pre">clustered-datastore-restore</span></code>
directory, if it exists. So for a successful restore, those two directories
should be empty. The backup file name itself does not matter, and the startup
process will delete it after a successful restore.</p>
<p>The backup is node independent, so when restoring a 3 node cluster, it is best
to restore it on each node for consistency. For example, if restoring on one
node only, it can happen that the other two empty nodes form a majority and
the cluster comes up with no data.</p>
</section>
</section>


    </div>
      
  </div>
</div>

<footer class="footer">
  <div class="container">
    <p class="pull-right">
      <a href="#">Back to top</a>
      
        <br/>
        
<div id="sourcelink">
  <a href="../_sources/getting-started-guide/persistence_and_backup.rst.txt"
     rel="nofollow">Source</a>
</div>
      
    </p>
    <p>
        &copy; Copyright 2016-2026, OpenDaylight Project.<br/>
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 8.2.3.<br/>
    </p>
  </div>
</footer>
  </body>
</html>